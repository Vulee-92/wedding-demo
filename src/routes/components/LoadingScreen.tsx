import React, { useState } from 'react';
import { motion } from 'framer-motion';
import { Box, Container, styled, Typography } from '@mui/material';

// SVG c·ªßa b·∫°n
const yourSvgPath = `
M2.048 46.392C1.19467 46.392 0.768 45.9867 0.768 45.176C0.768 44.9627 0.853333 44.6427 1.024 44.216C1.23733 43.832 1.536 43.2773 1.92 42.552L5.568 35.768C7.53067 32.2267 9.23733 28.984 10.688 26.04C12.1813 23.0533 13.4613 20.3867 14.528 18.04C17.728 10.744 19.328 5.21866 19.328 1.464C19.328 1.208 19.4987 0.909331 19.84 0.567997C20.224 0.226665 20.5867 0.0559998 20.928 0.0559998C21.44 0.0559998 21.696 0.546666 21.696 1.528C21.696 4.30133 20.6933 8.504 18.688 14.136C17.8773 16.2693 17.0453 18.3387 16.192 20.344C15.3387 22.3493 14.4427 24.2907 13.504 26.168C15.3387 23.9493 17.2373 21.7947 19.2 19.704C21.1627 17.6133 23.2107 15.5867 25.344 13.624C31.6587 7.69333 36.2667 4.728 39.168 4.728C41.0027 4.728 41.92 5.92266 41.92 8.312C41.92 10.872 40.6613 15.48 38.144 22.136C34.9013 30.4987 33.1093 35.2987 32.768 36.536C42.4533 24.8027 52.3093 16.248 62.336 10.872C63.7013 10.1467 65.1307 9.44266 66.624 8.76C68.16 8.03466 69.3333 7.672 70.144 7.672C71.3387 7.672 71.936 8.39733 71.936 9.848C71.936 10.5733 71.808 11.448 71.552 12.472C71.296 13.496 70.8693 14.6267 70.272 15.864L64.384 28.344C63.8293 29.5387 63.2107 30.8613 62.528 32.312C61.888 33.7627 61.2693 35.2133 60.672 36.664C60.1173 38.072 59.648 39.352 59.264 40.504C58.88 41.6133 58.688 42.4667 58.688 43.064C58.688 43.7467 58.9653 44.088 59.52 44.088C60.3733 44.088 61.44 43.576 62.72 42.552C64.0427 41.528 65.4507 40.2267 66.944 38.648C67.1573 38.392 67.4347 38.0933 67.776 37.752C68.16 37.4107 68.5013 37.24 68.8 37.24C69.4827 37.24 69.824 37.624 69.824 38.392C69.824 38.52 69.7813 38.6693 69.696 38.84C69.6107 38.968 69.4187 39.1813 69.12 39.48C68.5653 40.0347 68.0107 40.5893 67.456 41.144C66.9013 41.6987 66.3893 42.1893 65.92 42.616C64.8107 43.5547 63.6373 44.3867 62.4 45.112C61.2053 45.88 60.0533 46.264 58.944 46.264C57.1947 46.264 56.32 45.2827 56.32 43.32C56.32 42.1253 56.7467 40.2693 57.6 37.752C58.4533 35.2347 59.7547 32.056 61.504 28.216L68.224 13.624C68.6933 12.6427 68.992 11.96 69.12 11.576C69.248 11.1493 69.312 10.8507 69.312 10.68C69.312 10.424 69.2053 10.296 68.992 10.296C68.9067 10.296 68.672 10.36 68.288 10.488C67.9467 10.5733 67.328 10.8293 66.432 11.256C63.8293 12.4507 60.9707 14.0507 57.856 16.056C54.7413 18.0613 51.84 20.2373 49.152 22.584C46.976 24.4613 45.0347 26.2533 43.328 27.96C41.6213 29.6667 39.9573 31.4373 38.336 33.272C36.7147 35.1067 34.9227 37.1973 32.96 39.544C32.4053 40.184 32.0213 40.632 31.808 40.888C31.5947 41.1013 31.2533 41.208 30.784 41.208C30.0587 41.208 29.696 40.824 29.696 40.056C29.696 39.2453 29.8667 38.1787 30.208 36.856C30.5493 35.5333 30.976 34.1893 31.488 32.824L36.224 20.152C37.376 17.0373 38.2293 14.456 38.784 12.408C39.3387 10.36 39.616 8.824 39.616 7.8C39.616 6.94666 39.2533 6.52 38.528 6.52C37.12 6.52 33.9413 8.78133 28.992 13.304C27.2853 14.8827 25.6853 16.3973 24.192 17.848C22.6987 19.2987 21.3333 20.7067 20.096 22.072C18.432 23.864 16.9173 25.5707 15.552 27.192C14.1867 28.8133 12.864 30.4987 11.584 32.248C10.3467 33.9547 9.06667 35.8533 7.744 37.944C6.42133 40.0347 4.992 42.4667 3.456 45.24C3.02933 46.008 2.56 46.392 2.048 46.392ZM90.1 17.784C89.3747 17.784 89.012 17.4213 89.012 16.696C89.012 16.4827 89.1613 16.0987 89.46 15.544C89.7587 14.9467 90.1 14.3493 90.484 13.752C90.868 13.1547 91.1667 12.7493 91.38 12.536C92.1053 11.7253 92.66 11.2133 93.044 11C93.4707 10.7867 93.8547 10.68 94.196 10.68C95.092 10.68 95.54 11.0853 95.54 11.896C95.54 12.1947 95.348 12.5573 94.964 12.984C94.6227 13.368 94.2173 13.7307 93.748 14.072C93.0653 14.4987 92.6387 14.84 92.468 15.096L91.06 17.08C91.0173 17.2507 90.9107 17.4213 90.74 17.592C90.612 17.72 90.3987 17.784 90.1 17.784ZM79.22 43.704C78.0253 43.704 77.1507 43.4693 76.596 43C76.084 42.5307 75.828 41.8267 75.828 40.888C75.828 39.992 76.1053 38.776 76.66 37.24C77.2147 35.6613 77.9187 33.976 78.772 32.184C79.668 30.392 80.6067 28.6853 81.588 27.064C82.5693 25.4427 83.508 24.12 84.404 23.096C85.3427 22.0293 86.0893 21.496 86.644 21.496C87.412 21.496 87.796 21.8373 87.796 22.52C87.796 22.9467 87.4333 23.7573 86.708 24.952C85.9827 26.1467 85.1933 27.384 84.34 28.664C83.9987 29.1333 83.5293 29.7733 82.932 30.584C82.3347 31.3947 81.7587 32.1627 81.204 32.888C80.6493 33.5707 80.2867 34.04 80.116 34.296C79.6893 34.936 79.2413 35.9813 78.772 37.432C78.26 38.8827 78.004 39.992 78.004 40.76C78.004 41.1013 78.068 41.3573 78.196 41.528C78.3667 41.6987 78.7293 41.784 79.284 41.784C80.3507 41.784 81.5453 41.4427 82.868 40.76C84.1907 40.0773 85.5347 39.224 86.9 38.2C88.2653 37.1333 89.5453 36.0453 90.74 34.936C91.9773 33.8267 93.0227 32.8667 93.876 32.056C94.0467 31.8853 94.3027 31.8 94.644 31.8C95.284 31.8 95.604 32.056 95.604 32.568C95.604 33.0373 95.3053 33.5707 94.708 34.168C93.556 35.32 92.4893 36.344 91.508 37.24C90.5267 38.136 89.588 38.9253 88.692 39.608C87.284 40.632 85.7267 41.5707 84.02 42.424C82.3133 43.2773 80.7133 43.704 79.22 43.704ZM89.725 44.6C89.0423 44.6 88.701 44.3227 88.701 43.768C88.701 43.5547 88.7863 43.2987 88.957 43C89.1277 42.6587 89.277 42.3813 89.405 42.168L95.165 30.584C97.6397 25.5493 98.877 22.7547 98.877 22.2C98.877 21.6027 99.1757 21.304 99.773 21.304C100.584 21.304 100.989 21.7307 100.989 22.584C100.989 22.8827 100.797 23.5227 100.413 24.504C100.029 25.4853 99.5383 26.5947 98.941 27.832C97.917 30.0507 97.0637 31.7573 96.381 32.952C97.661 31.4587 98.9623 30.0507 100.285 28.728C101.608 27.4053 102.952 26.1467 104.317 24.952C108.37 21.4107 111.485 19.64 113.661 19.64C115.154 19.64 115.901 20.344 115.901 21.752C115.901 23.032 114.813 25.912 112.637 30.392C110.461 34.9147 109.373 37.7733 109.373 38.968C109.373 39.5227 109.565 39.8 109.949 39.8C110.077 39.8 110.269 39.7573 110.525 39.672C110.824 39.544 111.122 39.48 111.421 39.48C112.146 39.48 112.509 39.8213 112.509 40.504C112.509 41.3573 111.592 41.784 109.757 41.784C108.904 41.784 108.285 41.592 107.901 41.208C107.517 40.7813 107.325 40.2267 107.325 39.544C107.325 37.496 108.37 34.3813 110.461 30.2C112.552 26.0613 113.597 23.5653 113.597 22.712C113.597 22.2 113.405 21.944 113.021 21.944C112.082 21.944 110.568 22.7333 108.477 24.312C106.216 26.0187 103.954 27.9813 101.693 30.2C99.4317 32.4187 97.277 34.9573 95.229 37.816L90.749 44.024C90.493 44.408 90.1517 44.6 89.725 44.6ZM116.635 44.152C115.952 44.152 115.611 43.8107 115.611 43.128C115.611 42.232 115.931 40.824 116.571 38.904C117.211 36.9413 118.043 34.7013 119.067 32.184C120.133 29.624 121.264 27 122.459 24.312C123.141 22.8187 123.845 21.368 124.571 19.96C125.296 18.5093 125.979 17.2507 126.619 16.184C132.933 5.51733 136.859 0.183998 138.395 0.183998C138.992 0.183998 139.291 0.482665 139.291 1.08C139.291 1.464 138.992 2.18933 138.395 3.256C137.84 4.28 137.093 5.496 136.155 6.904C135.259 8.26933 134.277 9.656 133.211 11.064C132.187 12.472 131.205 13.7733 130.267 14.968C129.371 16.12 128.645 16.9947 128.091 17.592C127.621 18.1467 127.088 18.9573 126.491 20.024C125.936 21.0907 125.381 22.2 124.827 23.352C124.272 24.4613 123.824 25.4427 123.483 26.296L121.051 32.312C121.691 31.4587 122.523 30.4987 123.547 29.432C125.979 26.744 128.496 24.7173 131.099 23.352C133.744 21.944 135.963 21.24 137.755 21.24C138.736 21.24 139.525 21.5387 140.123 22.136C140.72 22.7333 141.019 23.4587 141.019 24.312C141.019 25.976 139.931 28.7707 137.755 32.696C135.579 36.5787 134.491 38.968 134.491 39.864C134.491 40.3333 134.747 40.568 135.259 40.568C136.453 40.568 137.755 40.1413 139.163 39.288C140.571 38.392 142.021 37.2613 143.515 35.896C145.008 34.5307 146.459 33.1653 147.867 31.8C148.037 31.6293 148.293 31.544 148.635 31.544C149.275 31.544 149.595 31.8 149.595 32.312C149.595 32.7813 149.296 33.3147 148.699 33.912C145.84 36.7707 143.387 38.904 141.339 40.312C139.291 41.72 137.136 42.424 134.875 42.424C133.168 42.424 132.315 41.6347 132.315 40.056C132.315 39.4587 132.421 38.8827 132.635 38.328C132.848 37.7733 133.189 37.0267 133.659 36.088L136.603 30.264C137.328 28.8133 137.861 27.5973 138.203 26.616C138.544 25.6347 138.715 24.888 138.715 24.376C138.715 23.6507 138.267 23.288 137.371 23.288C135.792 23.288 133.936 23.928 131.803 25.208C129.712 26.4453 127.472 28.3227 125.083 30.84C123.717 32.2907 122.48 33.8267 121.371 35.448C120.304 37.0693 119.451 38.8187 118.811 40.696L118.043 42.936C117.744 43.7467 117.275 44.152 116.635 44.152ZM181.693 27.768L165.629 27.704C164.946 27.704 164.605 27.3413 164.605 26.616C164.605 25.9333 164.946 25.592 165.629 25.592L181.821 25.656C182.461 25.656 182.781 25.976 182.781 26.616C182.781 27.384 182.418 27.768 181.693 27.768ZM201.068 46.776C200.343 46.776 199.98 46.4347 199.98 45.752C199.98 45.496 200.001 45.3253 200.044 45.24C201.623 41.784 205.911 36.6213 212.908 29.752C212.695 29.7947 212.503 29.8373 212.332 29.88C212.161 29.88 212.033 29.88 211.948 29.88C211.223 29.88 210.86 29.4747 210.86 28.664C210.86 28.1947 211.223 27.896 211.948 27.768C212.375 27.6827 212.823 27.6187 213.292 27.576C213.804 27.4907 214.444 27.3627 215.212 27.192C220.375 21.816 225.345 17.208 230.124 13.368C234.945 9.48533 239.553 6.30666 243.948 3.832C244.332 3.61866 244.673 3.448 244.972 3.32C245.271 3.14933 245.527 3.064 245.74 3.064C246.252 3.064 246.508 3.40533 246.508 4.088C246.508 5.368 245.228 9.76267 242.668 17.272L239.852 25.528C240.961 25.528 241.516 25.8693 241.516 26.552C241.516 27.32 240.791 27.704 239.34 27.704C238.529 29.9227 237.761 32.376 237.036 35.064C236.353 37.7093 235.777 40.44 235.308 43.256C235.137 44.152 234.753 44.6 234.156 44.6C233.431 44.6 233.068 44.216 233.068 43.448C233.068 43.32 233.111 43.0427 233.196 42.616C233.281 42.1893 233.409 41.6347 233.58 40.952C234.092 38.4773 234.54 36.4293 234.924 34.808C235.351 33.1867 235.713 31.8213 236.012 30.712C236.353 29.56 236.652 28.5147 236.908 27.576C229.057 27.7467 222.145 28.3227 216.172 29.304C214.465 31.0533 213.036 32.5467 211.884 33.784C210.732 34.9787 209.879 35.8747 209.324 36.472C206.764 39.288 204.716 41.848 203.18 44.152C203.052 44.3653 202.903 44.6427 202.732 44.984C202.519 45.3253 202.263 45.7307 201.964 46.2C201.793 46.584 201.495 46.776 201.068 46.776ZM218.796 26.68C221.271 26.3387 224.065 26.0827 227.18 25.912C230.295 25.6987 233.793 25.5493 237.676 25.464C238.316 23.5013 238.956 21.6027 239.596 19.768C240.236 17.8907 240.855 16.0987 241.452 14.392C242.177 12.5147 243.137 9.69866 244.332 5.944C239.383 8.80266 234.775 11.96 230.508 15.416C226.284 18.872 222.38 22.6267 218.796 26.68ZM244.35 44.6C243.667 44.6 243.326 44.3227 243.326 43.768C243.326 43.5547 243.411 43.2987 243.582 43C243.753 42.6587 243.902 42.3813 244.03 42.168L249.79 30.584C252.265 25.5493 253.502 22.7547 253.502 22.2C253.502 21.6027 253.801 21.304 254.398 21.304C255.209 21.304 255.614 21.7307 255.614 22.584C255.614 22.8827 255.422 23.5227 255.038 24.504C254.654 25.4853 254.163 26.5947 253.566 27.832C252.542 30.0507 251.689 31.7573 251.006 32.952C252.286 31.4587 253.587 30.0507 254.91 28.728C256.233 27.4053 257.577 26.1467 258.942 24.952C262.995 21.4107 266.11 19.64 268.286 19.64C269.779 19.64 270.526 20.344 270.526 21.752C270.526 23.032 269.438 25.912 267.262 30.392C265.086 34.9147 263.998 37.7733 263.998 38.968C263.998 39.5227 264.19 39.8 264.574 39.8C264.702 39.8 264.894 39.7573 265.15 39.672C265.449 39.544 265.747 39.48 266.046 39.48C266.771 39.48 267.134 39.8213 267.134 40.504C267.134 41.3573 266.217 41.784 264.382 41.784C263.529 41.784 262.91 41.592 262.526 41.208C262.142 40.7813 261.95 40.2267 261.95 39.544C261.95 37.496 262.995 34.3813 265.086 30.2C267.177 26.0613 268.222 23.5653 268.222 22.712C268.222 22.2 268.03 21.944 267.646 21.944C266.707 21.944 265.193 22.7333 263.102 24.312C260.841 26.0187 258.579 27.9813 256.318 30.2C254.057 32.4187 251.902 34.9573 249.854 37.816L245.374 44.024C245.118 44.408 244.777 44.6 244.35 44.6Z`;

interface LoadingScreenProps {
  onComplete: () => void;
}

const LoadingScreen: React.FC<LoadingScreenProps> = ({ onComplete }) => {
  const [opened, setOpened] = useState(false);
  const backgroundVariants = {
    hidden: { opacity: 0 },
    visible: {
      opacity: 1,
      transition: {
        duration: 1.5,
        ease: 'easeInOut',
      },
    },
  };
  const DateTable = styled(motion.div)(({ theme }) => ({
    display: 'grid',
    gridTemplateColumns: '1fr 2px 1fr 2px 1fr',
    justifyItems: 'center',
    alignItems: 'center',
    margin: theme.spacing(4, 0),
    [theme.breakpoints.down('sm')]: {
      gridTemplateColumns: '1fr 1px 1fr 1px 1fr',
    },
  }));
  
  const DateItem = styled(Box)(({ theme }) => ({
    display: 'flex',
    flexDirection: 'column',
    alignItems: 'center',
    padding: '0 10px',
    '& .label': {
      fontFamily: "'Playfair Display', serif",
      fontSize: 'clamp(0.8rem, 2vw, 1rem)',
      color: '#666',
    },
    '& .value': {
      fontFamily: "'Playfair Display', serif",
      fontSize: 'clamp(2.5rem, 6vw, 3.5rem)',
      color: '#333',
      fontWeight: 'bold',
      lineHeight: 1.2,
    },
    '& .separator': {
      width: '1px',
      height: '60px',
      backgroundColor: '#ccc',
    }
  }));
  const pathVariants = {
    hidden: { pathLength: 0, opacity: 0 },
    visible: {
      pathLength: 1,
      opacity: 1,
      transition: {
        duration: 1,
        ease: 'easeInOut',
      },
    },
  };
  const svgVariants = {
    hidden: { opacity: 0 },
    visible: {
      opacity: 1,
      transition: {
        duration: 1,
        when: 'beforeChildren',
        staggerChildren: 0.05,
      },
    },
  };
const staggerContainer = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.2,
      delayChildren: 0.2
    }
  }
};

const itemVariants = {
  hidden: { opacity: 1, y: 30 },
  visible: { opacity: 1, y: 0, transition: { duration: 0.6, ease: "easeOut" } }
};
  const handleOpen = () => {
    setOpened(true);
    setTimeout(() => {
      onComplete();
    }, 1200); // delay ƒë·ªÉ ch·∫°y hi·ªáu ·ª©ng xong r·ªìi m·ªõi g·ªçi
  };
  const MonthTitle = styled(Typography)(({ theme }) => ({
    fontFamily: "'Oooh Baby', cursive",
    fontSize: 'clamp(2rem, 5vw, 2.5rem)',
    color: '#000',
    textAlign: 'center',
    marginBottom: theme.spacing(2),
  }));
  return (
    <Container
      maxWidth={false}
      disableGutters
      sx={{
        height: '100vh',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        backgroundImage: 'url(/assets/images/wedding/hoahongnhe.png)',
        backgroundSize: 'cover',
        backgroundPosition: 'center',
        position: 'relative',
        overflow: 'hidden',
      }}
    >

      {/* Paper ph·ªß n·ª≠a d∆∞·ªõi */}
      <motion.div
        initial={{ y: '100%', opacity: 0 }}
        animate={{ y: '40%', opacity: 1 }}
        transition={{ duration: 1.2, ease: 'easeOut' }}
        style={{
          position: 'absolute',
          bottom: 0,
          left: 0,
          width: '100%',
          height: '100%',
          backgroundImage: 'url(/assets/images/paper.png)',
          backgroundSize: 'cover',
          backgroundPosition: 'center',
          borderTopLeftRadius: '20px',
          borderTopRightRadius: '20px',
          // boxShadow: '0 -4px 20px rgba(0,0,0,0.2)',
          zIndex: 1,
        }}
      />

      {/* Thi·ªáp + hoa n·∫±m gi·ªØa */}
      <Box
        sx={{
          position: 'relative',
          zIndex: 2,
          display: 'flex',
          flexDirection: 'column',
          alignItems: 'center',
        }}
      >
        <motion.svg
          xmlns="http://www.w3.org/2000/svg"
          width="271"
          height="47"
          viewBox="0 0 271 47"
          fill="none"
          style={{
            width: '250px',
            height: 'auto',
            stroke: '#928362',
            marginBottom: '50px',
            strokeWidth: '1',
            strokeLinecap: 'round',
            strokeLinejoin: 'round',
            zIndex: 1,
          }}
          variants={svgVariants}
          initial="hidden"
          animate="visible"
        >
          <motion.path d={yourSvgPath} variants={pathVariants} />
        </motion.svg>
        {/* Thi·ªáp */}
        <motion.img
          onClick={handleOpen}
          src="/assets/images/thieppng.png"
          alt="Wedding Envelope"
          initial={{ opacity: 0, y: -50, scale: 0.9 }}
          animate={{
            opacity: 1,
            y: 0,
            scale: opened ? 1.2 : 1,
            rotate: opened ? 5 : 0,
          }}
          transition={{ duration: 1, type: 'spring' }}
          whileHover={{ scale: 1.05 }}
          style={{
            maxWidth: '300px',
            height: 'auto',
            cursor: 'pointer',
            zIndex: 2,
          }}
        />

        {/* Hoa ph·ªß l√™n thi·ªáp */}
        <motion.img
          src="/assets/images/flow1.png"
          alt="Flower"
          initial={{ opacity: 0, scale: 0.85 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ duration: 1.2, delay: 0.5 }}
          style={{
            position: 'absolute',
            left: '-210px',
            bottom: '-100px',
            width: '360px',
            zIndex: 3,
            pointerEvents: 'none',
          }}
        />

        {/* Ch·ªØ h∆∞·ªõng d·∫´n */}
        {!opened && (
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 1.5, delay: 1 }}
            style={{
              marginTop: '12px',
              color: '#6b4f2d',
              fontFamily: 'serif',
              fontSize: '16px',
              fontStyle: 'italic',
              textAlign: 'center',
            }}
          >
            Nh·∫•p v√†o thi·ªáp ƒë·ªÉ m·ªü üíå
          </motion.div>
        )}
      </Box>

      {/* N·ªôi dung b√™n trong paper */}
      <Box
        sx={{
          position: 'absolute',
          bottom: 0,
          width: '100%',
          maxWidth: 600,
          mx: 'auto',
          p: 4,
          textAlign: 'center',
          color: '#6b4f2d',
          fontFamily: 'serif',
          zIndex: 2,
        }}
      >
        {/* <MonthTitle>
          HTTL H√† N·ªôi
        </MonthTitle> */}

        <DateTable variants={staggerContainer}>

          <motion.div variants={itemVariants}>
            <DateItem>
              <Typography className="label">Th·ª© 7</Typography>
              <Typography className="value">27</Typography>
            </DateItem>
          </motion.div>
          <Box sx={{ width: '1px', height: '60px', backgroundColor: '#ccc' }} />
          <motion.div variants={itemVariants}>
            <DateItem>
              <Typography className="label">TH√ÅNG</Typography>
              <Typography className="value">09</Typography>
            </DateItem>
          </motion.div>
          <Box sx={{ width: '1px', height: '60px', backgroundColor: '#ccc' }} />
          <motion.div variants={itemVariants}>
            <DateItem>
              <Typography className="label">NƒÇM</Typography>
              <Typography className="value">2025</Typography>
            </DateItem>
          </motion.div>
        </DateTable>
      </Box>
    </Container>
  );
};

export default LoadingScreen;
